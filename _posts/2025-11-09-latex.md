---
title: "Latexに関して"
layout: post
---

基本的にこれからLatexを始める場合はLuaLatexを使うのが良いと思う．
Macの場合はbrewでMacTexをbrewでGUIアプリなしでインストールし：
```zsh 
brew cask install mactex-no-gui
sudo tlmgr update --self --all
sudo tlmgr paper a4
```
TexShopやLateXiTといったGUIアプリは必要に応じて後から別にインストールする．

ユーザディレクトリの直下に``.latexmkrc``というファイルを作り以下のようにする：
```zsh
#!/usr/bin/env perl

# latex commands
$latex            = 'uplatex -synctex=1　-halt-on-error　-interaction=nonstopmode -file-line-error %O %S';
$latex_silent     = 'uplatex -synctex=1 -halt-on-error -interaction=batchmode -file-line-error %O %S';
$lualatex         = 'lualatex %O -shell-escape -synctex=1 -interaction=nonstopmode -file-line-error %S';
$xelatex          = 'xelatex %O -no-pdf -synctex=1 -shell-escape -interaction=nonstopmode %S';
$bibtex           = 'python3 mixej.py %B; upbibtex %O %B; python3 mixej.py %B';
$bibtex 		  = 'upbibtex %O %B';
$biber            = 'biber %O --bblencoding=utf8 -u -U --output_safechars %O %S';
$dvipdf           = 'dvipdfmx -V 5 %O -o %D %S -z 0 -I 0 -d 5';
$dvips            = 'dvips %O -z -f %S | convbkmk -u > %D';
# $pdflatex 		  = 'pdflatex %O -synctex=1 %S';
$makeindex        = 'upmendex %O -o %D %S';
$max_repeat       = 6;
$ps2pdf 		  = 'ps2pdf %O %S %D';

# index
$makeindex = 'mendex %O -o %D %S';

#pdf mode
$pdf_mode         = 4;# 0: none, 1: pdflatex, 2: dvips to ps2pdf, 3: dvipdfmx, 4: lualatex

# Prevent latexmk from removing PDF after typeset.
# This enables Skim to chase the update in PDF automatically.
# preview
$pvc_view_file_via_temporary = 0;
if ($^O eq 'linux') {
    $dvi_previewer = "xdg-open %S";
    $pdf_previewer = "xdg-open %S";
} elsif ($^O eq 'darwin') {
    $dvi_previewer = "open %S";
    $pdf_previewer = "open %S";
} else {
    $dvi_previewer = "start %S";
    $pdf_previewer = "start %S";
}

# Use Skim as a previewer on Mac OS X
$pdf_previewer    = "open -ga /Applications/Skim.app";
@generated_exts = (@generated_exts, 'synctex.gz');
```

上の例ではpdfビューアーとしてskimを利用しているためbrew等でインストールが必要
なお，vscodeのみで編集する場合はインストールの必要はない．

シェルを再起動して，例えば```sample.tex```をコンパイルする場合は，
```zsh
latexmk -pvc sample.tex
```

パッケージを新しく追加したなどで更新が必要な場合は以下のコマンドを実行する：
```zsh 
sudo mktexlsr
```
